<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>カード配置システム</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        .field {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .slot {
            width: 100px;
            height: 140px;
            border: 2px solid black;
            background-color: white;
            position: relative;
        }
        .card {
            width: 100px;
            height: 140px;
            position: absolute;
            cursor: grab;
        }
        .card.top {
            z-index: 2;
            top: 0;
        }
        .card.bottom {
            z-index: 1;
            top: 20px;
        }
    </style>
</head>
<body>

    <div class="field">
        <div class="slot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        <div class="slot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        <div class="slot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        <div class="slot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        <div class="slot" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>

    <div>
        <img src="card.png" class="card" draggable="true" ondragstart="drag(event)">
    </div>

    <script>
        function allowDrop(event) {
            event.preventDefault();
        }

        function drag(event) {
            event.dataTransfer.setData("text", event.target.outerHTML);
        }

        function drop(event) {
            event.preventDefault();
            let slot = event.target.closest('.slot');
            let existingCards = slot.querySelectorAll('.card');

            if (existingCards.length >= 2) {
                alert("このスロットには2枚までしか配置できません。");
                return;
            }

            let newCard = document.createElement("div");
            newCard.innerHTML = event.dataTransfer.getData("text");
            let cardElement = newCard.firstChild;

            if (existingCards.length === 1) {
                let choice = confirm("上に配置しますか？（キャンセルで下に配置）");
                if (choice) {
                    // 上に配置 → 既存のカードを下にずらす
                    existingCards[0].classList.remove("top");
                    existingCards[0].classList.add("bottom");
                    cardElement.classList.add("top");
                } else {
                    // 下に配置
                    cardElement.classList.add("bottom");
                }
            } else {
                cardElement.classList.add("top");
            }

            slot.appendChild(cardElement);
        }
    </script>

</body>
</html>
